Short answer: one sign-up. Three role-specific onboardings. One database (single users table/collection) with clean namespacing. That’s the simplest. It scales. And it lets one person hold multiple roles later (e.g., a founder hiring for their startup who also wants a personal job-seeker profile).

Here’s exactly how I’d set it up on Replit with our Express app.

# The structure I recommend

* Single **User** record on sign-up.
* User selects a **Role**: `Individual` (candidate) • `Business` (employer) • `Recruiter` (agency).
* After sign-up, show a **role-specific onboarding** form that creates/attaches the right profile.
* Keep data in one store with **namespaced keys** (Replit DB) or one set of collections if you later move to Postgres.

# Why not 3 separate sign-ups?

* Users sometimes need multiple roles. One account avoids duplicates and login headaches.
* Shared services (auth, billing, notifications) are simpler with one user table.
* Unified analytics. Cleaner permissions. Easier upgrades/downgrades.

# UX flow (fast + low friction)

1. **Auth step**

   * Ask for email only.
   * Send **magic link** (passwordless). Faster than password creation and perfect for MVP.
   * Optional later: add classic email+password or social sign-in.

2. **Role pick**

   * Screen: “How will you use SA Jobs?”
     Buttons: `Find a job` (Individual) • `Hire for my company` (Business) • `I’m a recruiter/agency` (Recruiter).

3. **Role-specific onboarding (minimal)**

   * **Individual**

     * Name, location (province + city), job title, experience level.
     * CV upload (PDF). Skills (chips). Visibility toggle.
   * **Business (Employer)**

     * Company name, website, province/city, industry, size, logo.
     * You become **Org Owner**. You can invite teammates later.
   * **Recruiter (Agency)**

     * Agency name, website, sectors, proof link (LinkedIn/company page).
     * Flag account as **Needs Verification** if you plan to gate posting volume.

4. **First-run actions**

   * Individual → “Build your CV / Set up job alerts.”
   * Business → “Post your first job.”
   * Recruiter → “Connect a client company” or “Post a role” (if verified).

# Data model (Replit DB namespaces)

Keep one logical database. Separate entities by key prefix.

* `user:{id}`

  ```json
  {
    "id": "uuid",
    "email": "user@example.com",
    "roles": ["individual"],  // can be multiple
    "createdAt": 1730...
  }
  ```
* `profile:candidate:{userId}`
  Name, province, city, title, skills[], cvUrl, visibility.
* `org:{id}`
  Name, type: "employer" | "agency", website, province, city, logoUrl, createdAt.
* `membership:{userId}:{orgId}`
  RoleInOrg: "owner" | "admin" | "poster" | "viewer".
* `profile:recruiter:{userId}`
  sectors[], verificationStatus: "pending" | "approved" | "rejected".
* `job:{id}`
  orgId, postedByUserId, title, province, city, employmentType, workType, salaryMin/Max, descriptionMd/Html, createdAt.

> Your current `job` schema from the MVP fits right in; just add `orgId` and `postedByUserId`.

# API endpoints to add

* **Auth (passwordless)**

  * `POST /auth/magic/start` → body: { email } → send link with a one-time token.
  * `GET /auth/magic/verify?token=...` → verifies, creates `user:{id}` if needed, sets HttpOnly session cookie (JWT).
  * `POST /auth/logout`
* **Role + onboarding**

  * `POST /me/role` → body: { role } updates `user.roles`.
  * `POST /me/profile/candidate`
  * `POST /orgs` → create employer/agency org (derive type from chosen role).
  * `POST /orgs/:id/invite` (later)
* **Jobs**

  * `POST /api/jobs` now requires auth + checks:

    * If `org.type === "employer"` → allow posting for that org.
    * If `org.type === "agency"` → allow posting, but maybe limit until verified.

# Auth/session notes (Express)

* Use a short-lived JWT in an **HttpOnly, Secure** cookie.
* Store magic-link tokens in `magic:{token}` with userEmail + expiry (5–10 min).
* Middleware `requireAuth` populates `req.user`.
* Middleware `requireRole('recruiter' | 'business' | 'individual')` for gated routes.

# Permissions matrix (simple + clear)

* **Individual**: edit own candidate profile. Save jobs. Apply. Make CV public/private.
* **Business**: create org, manage jobs for that org, invite teammates.
* **Recruiter**: create agency org, manage jobs for agency and optionally link to client orgs.
* **Admin (you)**: verify agencies, rate-limit, moderate posts.

# Pricing/limits (easy toggles from day one)

Add flags you can change without code:

* In `org:{id}`: `plan: "free" | "pro"`, `jobPostLimit`, `isVerified`.
* In `user:{id}`: `featureFlags: { canCreateOrg: true }`.

# POPIA basics (South Africa)

* Collect the minimum needed.
* Add a consent checkbox at sign-up for storing personal data and sending alerts.
* Give an easy “delete my data” action in account settings.

# What to build next (I can wire this for you)

* Magic-link auth (tokens + email provider: Resend/Mailgun/Sendgrid).
* Role pick screen + three tiny onboarding forms.
* Org creation for Business/Recruiter.
* Update `POST /api/jobs` to require `orgId` + permission checks.

If you want, I’ll drop the exact Express routes, middleware, and minimal front-end screens into your Replit project next.
