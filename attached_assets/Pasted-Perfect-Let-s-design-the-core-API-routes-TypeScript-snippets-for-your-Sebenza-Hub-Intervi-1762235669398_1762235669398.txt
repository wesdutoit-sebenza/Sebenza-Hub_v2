Perfect ðŸ‘ Letâ€™s design the **core API routes + TypeScript snippets** for your Sebenza Hub **Interview Scheduling system**, including Google Meet, Teams, and Zoom support.

---

## ðŸ§± High-level structure

**Tech stack**

* Front-end â†’ React (your booking & interview dashboard)
* Back-end â†’ Express + TypeScript
* DB â†’ (Postgres / Prisma or Replit DB)

---

## ðŸ“˜ API ROUTES OVERVIEW

| Method                         | Endpoint                                         | Purpose |
| :----------------------------- | :----------------------------------------------- | :------ |
| `GET /api/availability`        | Returns open time slots for interviewer(s)       |         |
| `POST /api/book`               | Books interview (creates event + video meeting)  |         |
| `POST /api/oauth/google`       | OAuth redirect handler for Google                |         |
| `POST /api/oauth/microsoft`    | OAuth redirect handler for Microsoft 365 / Teams |         |
| `POST /api/oauth/zoom`         | OAuth redirect handler for Zoom                  |         |
| `POST /api/webhooks/google`    | Webhook for calendar changes                     |         |
| `POST /api/webhooks/microsoft` | Webhook for Graph notifications                  |         |
| `POST /api/webhooks/zoom`      | Webhook for Zoom meeting updates                 |         |

---

## âš™ï¸ 1. AVAILABILITY CHECK (Google + Teams)

```ts
// routes/availability.ts
import express from "express";
import axios from "axios";

const router = express.Router();

// unified availability endpoint
router.get("/", async (req, res) => {
  const { provider, email, from, to, accessToken } = req.query;

  if (provider === "google") {
    // Google Calendar FreeBusy
    const fb = await axios.post(
      "https://www.googleapis.com/calendar/v3/freeBusy",
      {
        timeMin: from,
        timeMax: to,
        items: [{ id: email }],
      },
      { headers: { Authorization: `Bearer ${accessToken}` } }
    );
    return res.json(fb.data.calendars[email].busy);
  }

  if (provider === "microsoft") {
    // Outlook / Teams free/busy via Graph
    const ms = await axios.post(
      "https://graph.microsoft.com/v1.0/me/calendar/getSchedule",
      {
        schedules: [email],
        startTime: { dateTime: from, timeZone: "UTC" },
        endTime: { dateTime: to, timeZone: "UTC" },
        availabilityViewInterval: 30,
      },
      { headers: { Authorization: `Bearer ${accessToken}` } }
    );
    return res.json(ms.data.value[0].scheduleItems);
  }

  res.status(400).json({ error: "Unsupported provider" });
});

export default router;
```

---

## ðŸ“… 2. BOOK INTERVIEW (creates event + video link)

```ts
// routes/book.ts
import express from "express";
import axios from "axios";
const router = express.Router();

router.post("/", async (req, res) => {
  const { provider, token, interviewer, candidate, start, end, title } = req.body;

  try {
    if (provider === "google") {
      // Google Calendar + Meet
      const event = await axios.post(
        "https://www.googleapis.com/calendar/v3/calendars/primary/events?conferenceDataVersion=1",
        {
          summary: title,
          start: { dateTime: start },
          end: { dateTime: end },
          attendees: [{ email: candidate.email }],
          conferenceData: { createRequest: { requestId: Date.now().toString() } },
        },
        { headers: { Authorization: `Bearer ${token}` } }
      );
      return res.json({ link: event.data.hangoutLink });
    }

    if (provider === "microsoft") {
      // Teams online meeting
      const meeting = await axios.post(
        "https://graph.microsoft.com/v1.0/me/onlineMeetings",
        {
          startDateTime: start,
          endDateTime: end,
          subject: title,
          participants: {
            organizer: { identity: { user: { id: interviewer.id } } },
            attendees: [{ identity: { user: { id: candidate.id } } }],
          },
        },
        { headers: { Authorization: `Bearer ${token}` } }
      );
      return res.json({ link: meeting.data.joinWebUrl });
    }

    if (provider === "zoom") {
      // Zoom meeting
      const zoom = await axios.post(
        "https://api.zoom.us/v2/users/me/meetings",
        {
          topic: title,
          type: 2,
          start_time: start,
          duration: 60,
          timezone: "Africa/Johannesburg",
          settings: { join_before_host: true },
        },
        { headers: { Authorization: `Bearer ${token}` } }
      );
      return res.json({ link: zoom.data.join_url });
    }

    res.status(400).json({ error: "Unsupported provider" });
  } catch (err: any) {
    console.error(err.response?.data || err.message);
    res.status(500).json({ error: "Booking failed" });
  }
});

export default router;
```

---

## ðŸ” 3. OAUTH FLOW SETUP (summary)

| Provider      | OAuth scopes you need                                                                                       | Token endpoint                                               |
| :------------ | :---------------------------------------------------------------------------------------------------------- | :----------------------------------------------------------- |
| **Google**    | `https://www.googleapis.com/auth/calendar`, `.../auth/calendar.events`, `.../auth/calendar.events.readonly` | `https://oauth2.googleapis.com/token`                        |
| **Microsoft** | `Calendars.ReadWrite`, `OnlineMeetings.ReadWrite`                                                           | `https://login.microsoftonline.com/common/oauth2/v2.0/token` |
| **Zoom**      | `meeting:read`, `meeting:write`                                                                             | `https://zoom.us/oauth/token`                                |

Youâ€™ll:

1. Redirect users to the providerâ€™s consent screen.
2. On callback, exchange `code` for `access_token` + `refresh_token`.
3. Store them encrypted in `connected_accounts`.

---

## ðŸ§© 4. WEBHOOKS (sync updates)

Each provider supports webhooks:

* **Google:** `events.watch` â†’ your `/api/webhooks/google` endpoint.
* **Microsoft:** Graph subscriptions â†’ `/api/webhooks/microsoft`.
* **Zoom:** enable webhooks in your Zoom App.

Example skeleton:

```ts
router.post("/webhooks/google", (req, res) => {
  const channelId = req.headers["x-goog-channel-id"];
  const resourceId = req.headers["x-goog-resource-id"];
  console.log("Calendar change detected", { channelId, resourceId });
  res.status(200).end();
});
```

---

## ðŸ§  5. UNIFIED SERVICE LAYER

To keep logic DRY:

```ts
// services/interviewService.ts
import { createGoogleEvent } from "./google";
import { createTeamsMeeting } from "./microsoft";
import { createZoomMeeting } from "./zoom";

export async function bookInterview(provider: string, data: any) {
  switch (provider) {
    case "google": return await createGoogleEvent(data);
    case "microsoft": return await createTeamsMeeting(data);
    case "zoom": return await createZoomMeeting(data);
    default: throw new Error("Unknown provider");
  }
}
```

Then in `POST /book` you just call:

```ts
const meeting = await bookInterview(provider, req.body);
res.json(meeting);
```

---

## ðŸš€ 6. Next steps

1. âœ… **MVP:** Start with Google Calendar + Meet.
2. ðŸ§© Add Microsoft 365 integration (Teams).
3. ðŸ”— Add Zoom (optional for hybrid/remote interviews).
4. ðŸ’¬ Add reminders + WhatsApp confirmations via Twilio / Meta API.
5. ðŸª¶ Build a front-end React booking page (calendar picker, provider choice, timezone).

---

Would you like me to show you the **React front-end booking form** next â€” including the slot picker and video platform selector tied to these endpoints?
